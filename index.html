<!DOCTYPE html>
<html>
<head>
<title>Appointments</title>
<style>
body { font-family: Arial; margin: 0; padding: 10px; background: #f5f5f5; }
.container { width: 99vw; margin: 0 auto; background: white; padding: 15px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
.header { background: #a100ff; color: white; padding: 20px; border-radius: 8px; text-align: center; margin-bottom: 20px; }
table { width: 100%; border-collapse: collapse; font-size: 14px; }
th { background: #f8f8f8; padding: 12px; text-align: left; border-bottom: 2px solid #a100ff; }
td { padding: 10px; border-bottom: 1px solid #ddd; }
.past { background: #FFA500 !important; } /* Orange for past appointments */
.upcoming { background: #90EE90 !important; } /* Light green for upcoming */
.current { background: #87CEEB !important; } /* Sky blue for current */
tr:hover { background: #f0f0f0 !important; }
.footer { text-align: center; margin-top: 20px; padding: 15px; color: #666; font-size: 13px; border-top: 1px solid #eee; }

/* Additional table styles to replace the duplicate block */
table th { background: #f8f8f8; color: #333; padding: 16px; text-align: left; font-weight: bold; border-bottom: 2px solid #a100ff; }
table td { padding: 14px; border-bottom: 1px solid #eee; }
table tr:hover { background: #f0f0f0 !important; }
</style>
</head>
<body>
<div class="container">
<div class="header">
<h2 style="color:white;margin:0;font-size:28px">ðŸ“… TODAY'S APPOINTMENTS</h2>
<div style="margin-top:8px;font-size:16px" id="timestamp">13-10-2025 08:23:51</div>
</div><table style="width: 100%; border-collapse: collapse; font-family: Arial, sans-serif; background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.1);"><thead><tr><th>Date:</th><th>TimeSlot:</th><th>Appointment Type:</th><th> IncidentNumber:</th><th>EnterpriseID:</th><th>Office:</th><th>LTSagent:</th></tr></thead><tbody><tr><td>13-10-2025</td><td>10:00 - 10:30</td><td>Incident Based</td><td>INC53094251</td><td>john.doe.test</td><td>Amsterdam</td><td>LTSagent1</td></tr><tr><td>13-10-2025</td><td>12:30 - 13:00</td><td>Laptop Replacement</td><td>INC53554251</td><td>john.doe.test</td><td>Amsterdam</td><td>LTSagent2</td></tr><tr><td>13-10-2025</td><td>14:00 - 14:30</td><td>Mobile Phone Replacement</td><td>INC53094251</td><td>john.doe.test</td><td>Amsterdam</td><td>LTSagent3</td></tr></tbody></table><div class="footer">Last update: <span id="lastUpdate">08:23:51</span></div>
</div>
<script>
function updateTime(){
    const now = new Date();
    if(document.getElementById("timestamp")){
        document.getElementById("timestamp").textContent = now.toLocaleDateString("en-GB", {day:"2-digit", month:"2-digit", year:"numeric", hour:"2-digit", minute:"2-digit", second:"2-digit", hour12:false});
    }
    if(document.getElementById("lastUpdate")){
        document.getElementById("lastUpdate").textContent = now.toLocaleTimeString("en-GB", {hour12:false});
    }
    
    const rows = document.querySelectorAll("tbody tr");
    rows.forEach(row => {
        const timeCell = row.cells[1];
        if(timeCell && timeCell.textContent){
            const timeMatch = timeCell.textContent.trim().match(/(\d{1,2}):(\d{2})\s*-\s*(\d{1,2}):(\d{2})/);
            if(timeMatch){
                const startHours = parseInt(timeMatch[1]);
                const startMinutes = parseInt(timeMatch[2]);
                const endHours = parseInt(timeMatch[3]);
                const endMinutes = parseInt(timeMatch[4]);
                
                const startTime = new Date();
                startTime.setHours(startHours, startMinutes, 0, 0);
                const endTime = new Date();
                endTime.setHours(endHours, endMinutes, 0, 0);
                
                row.classList.remove("past", "current", "upcoming");
                
                if(now > endTime){
                    row.classList.add("past");
                } else if(now >= startTime && now <= endTime){
                    row.classList.add("current");
                } else {
                    row.classList.add("upcoming");
                }
            }
        }
    });
}
setInterval(updateTime, 1000);
updateTime();
</script>
</body>
</html>