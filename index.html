<!DOCTYPE html>
<html>
<head>
<title>Appointments</title>
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate, max-age=0">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">
<meta name="timestamp" content="2025-10-29T08:20:03.6776688Z">
<script>
// Force immediate refresh when page loads
if (performance.navigation.type === 2) {
    // Page was loaded via back/forward - force reload
    window.location.reload(true);
}
</script>
<style>
body { font-family: Arial; margin: 0; padding: 10px; background: #f5f5f5; }
.container { width: 99vw; margin: 0 auto; background: white; padding: 15px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
.header { background: #a100ff; color: white; padding: 20px; border-radius: 8px; text-align: center; margin-bottom: 20px; }
table { width: 100%; border-collapse: collapse; font-size: 14px; }
th { background: #f8f8f8; padding: 12px; text-align: left; border-bottom: 2px solid #a100ff; }
td { padding: 10px; border-bottom: 1px solid #ddd; }
.past { background: #FFA500 !important; } /* Orange for past appointments */
.upcoming { background: #90EE90 !important; } /* Light green for upcoming */
.current { background: #87CEEB !important; } /* Sky blue for current */
tr:hover { background: #f0f0f0 !important; }
.footer { text-align: center; margin-top: 20px; padding: 15px; color: #666; font-size: 13px; border-top: 1px solid #eee; }

/* Additional table styles to replace the duplicate block */
table th { background: #f8f8f8; color: #333; padding: 16px; text-align: left; font-weight: bold; border-bottom: 2px solid #a100ff; }
table td { padding: 14px; border-bottom: 1px solid #eee; }
table tr:hover { background: #f0f0f0 !important; }
</style>
</head>
<body>
<div class="container">
<div class="header">
<h2 style="color:white;margin:0;font-size:28px">ðŸ“… TODAY'S APPOINTMENTS</h2>
<div style="margin-top:8px;font-size:16px" id="timestamp">29-10-2025 08:20:03</div>
</div><table border="1" cellspacing="0" cellpadding="3" style="border-collapse: collapse; font-family: Arial, sans-serif; width: 100%;"><thead><tr><th style="text-align: left; padding: 5px; background-color: #f8f8f8; border: 1px solid #ddd;">Date:</th><th style="text-align: left; padding: 5px; background-color: #f8f8f8; border: 1px solid #ddd;">TimeSlot:</th><th style="text-align: left; padding: 5px; background-color: #f8f8f8; border: 1px solid #ddd;">Appointment Type:</th><th style="text-align: left; padding: 5px; background-color: #f8f8f8; border: 1px solid #ddd;"> IncidentNumber:</th><th style="text-align: left; padding: 5px; background-color: #f8f8f8; border: 1px solid #ddd;">EnterpriseID:</th><th style="text-align: left; padding: 5px; background-color: #f8f8f8; border: 1px solid #ddd;">Office:</th><th style="text-align: left; padding: 5px; background-color: #f8f8f8; border: 1px solid #ddd;">LTSagent:</th></tr></thead><tbody><tr><td>29-10-2025</td><td>09:00 - 09:15</td><td>manon.den.dekker</td><td>Appointment- LTS: m.asfour</td><td>LTS</td><td>INC54126186</td><td></td></tr></tbody></table><div class="footer"></div>
</div>
<script>
// Force refresh every 1 second (1000 milliseconds)
setTimeout(function() {
    window.location.reload(true);
}, 1000);

function updateTime(){
    const now = new Date();
    if(document.getElementById("timestamp")){
        document.getElementById("timestamp").textContent = now.toLocaleDateString("en-GB", {day:"2-digit", month:"2-digit", year:"numeric", hour:"2-digit", minute:"2-digit", second:"2-digit", hour12:false});
    }
    
    const rows = document.querySelectorAll("tbody tr");
    rows.forEach(row => {
        const timeCell = row.cells[1];
        if(timeCell && timeCell.textContent){
            const timeMatch = timeCell.textContent.trim().match(/(\d{1,2}):(\d{2})\s*-\s*(\d{1,2}):(\d{2})/);
            if(timeMatch){
                const startHours = parseInt(timeMatch[1]);
                const startMinutes = parseInt(timeMatch[2]);
                const endHours = parseInt(timeMatch[3]);
                const endMinutes = parseInt(timeMatch[4]);
                
                const startTime = new Date();
                startTime.setHours(startHours, startMinutes, 0, 0);
                const endTime = new Date();
                endTime.setHours(endHours, endMinutes, 0, 0);
                
                row.classList.remove("past", "current", "upcoming");
                
                if(now > endTime){
                    row.classList.add("past");
                } else if(now >= startTime && now <= endTime){
                    row.classList.add("current");
                } else {
                    row.classList.add("upcoming");
                }
            }
        }
    });
}
setInterval(updateTime, 1000);
updateTime();
</script>
</body>
</html>